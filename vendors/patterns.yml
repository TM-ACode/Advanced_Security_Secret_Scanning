name: Vendors

patterns:
  - name: Azure SQL Connection String
    type: azure_sql_connection_string
    regex:
      pattern: |
        (?i)[a-z][a-z0-9-]+\.database(?:\.secure)?\.(?:(?:windows|usgovcloudapi)\.net|chinacloudapi\.cn|cloudapi\.de)
    comments:
      - "Removed from Secret Scanning for private repositories: https://github.blog/changelog/2021-10-18-secret-scanning-no-longer-supports-azure-sql-connection-strings-in-private-repos/"
    expected:
      - name: azure.js
        start_offset: 27
        end_offset: 61


  - name: Grafana API token
    type: grafana_api_token
    regex:
      pattern: |
        eyJrIjoi[A-Za-z0-9_=-]{42}
    expected:
      - name: grafana.txt
        start_offset: 107
        end_offset: 157
      - name: grafana.txt
        start_offset: 159
        end_offset: 209


  - name: SendGrid (deprecated)
    type: sendgrid
    regex:
      pattern: |
        SG\.[a-zA-Z0-9-]{5,}\.[a-zA-Z0-9-]{5,}
      end: |
        \z|[^a-zA-Z0-9-]
    comments:
      - "Deprecated (supported by Secret Scanning)"
    expected:
      - name: sendgrid.py
        start_offset: 20
        end_offset: 89

  - name: Okta token
    type: okta_token
    regex:
      version: 0.1
      pattern: |
        (0{2}[0-9A-Za-z_-]{40})
      start: |
        (\A|[^0-9A-Za-z_+/-])
      end: |
        (\z|[^0-9A-Za-z_+/=-])
      additional_not_match:
        # Avoid Hexadecimal only 
        - ^(0x)?[0-9A-Fa-f\-]+x?$
        # Avoid char only - in string quotes to avoid YAML parsing issues
        - "[a-zA-Z_-]{20,}"
        # Avoid big number with exponent
        - ^\d+(\.\d+)?e[+-]?\d+$
        # Don't hit on long strings of numbers and underscores only
        - "[\\d_]{25}"

    expected:
      - name: okta.txt
        start_offset: 12
        end_offset: 54
      - name: okta.txt
        start_offset: 68
        end_offset: 110
      - name: okta.txt
        start_offset: 127
        end_offset: 169
      - name: okta.txt
        start_offset: 180
        end_offset: 222

    comments:
      - Okta token, starting with `00` and 40 random alphanumeric with _ and -
 
