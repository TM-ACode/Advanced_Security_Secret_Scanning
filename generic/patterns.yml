
name: Generic Secrets / Passwords

patterns:
  - name: Generic Passwords
    type: generic_passwords
    regex:
      version: 0.4
      pattern: |
        [a-zA-Z0-9\t !.,$%&*+?^_`{|}()[\]\\/~-]+
      start: |
        (?i)(?:api|jwt|mysql)?[_.-]?(?:pass?(?:wo?r?d|code|phrase)?|pwd|secret|token)[\t ]*[=:][\t ]*["']?
      end: |
        (\z|[\r\n'"])
      additional_not_match:
        - \b((?i)(?:pass?(wo?r?d|code|phrase)?|pwd|secret|token|write|read|on|off|true|false|placeholder|dummy)\b
        - ^[\t \r\n"'()${}].*

    expected:
      - name: passwords.js
        start_offset: 14
        end_offset: 25
      - name: passwords.js
        start_offset: 41
        end_offset: 62

    comments:
      - "`password`, `secret`, `key`, or password like prefix (fuzzy)"
      - "Delimiters like `=` or `:` (with padding)"
      - "String with a number of chars until a breaking char"
      - "Not matching variables, placeholders or common configuration constants such as 'read' and 'write'"

  - name: UUIDs
    type: uuids
    regex:
      version: 0.1
      pattern: |
        [0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}
